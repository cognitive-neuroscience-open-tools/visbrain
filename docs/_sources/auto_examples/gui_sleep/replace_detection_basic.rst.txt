
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/gui_sleep/replace_detection_basic.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_gui_sleep_replace_detection_basic.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_gui_sleep_replace_detection_basic.py:


Replace detection algorithm : basic example
===========================================

This example illustrates how to replace the default detection algorithm.

.. warning::

    After running this script, just go to the Detection panel and run the
    selected detection by clicking on Apply. The software will automatically
    use your new detection algorithm. The Python console should confirm that
    you're using the new method and not the default method.

Required dataset at :
https://www.dropbox.com/s/bj1ra95rbksukro/sleep_edf.zip?dl=1

.. image:: ../../_static/examples/ex_replace_detection_basic.png

.. GENERATED FROM PYTHON SOURCE LINES 20-22

Load your file and create an instance of Sleep
##############################################################################

.. GENERATED FROM PYTHON SOURCE LINES 22-41

.. code-block:: Python


    import os
    import numpy as np

    from visbrain.gui import Sleep
    from visbrain.io import download_file, path_to_visbrain_data

    # Download the file :
    download_file('sleep_edf.zip', unzip=True, astype='example_data')
    target_path = path_to_visbrain_data(folder='example_data')

    # Get data path :
    dfile = os.path.join(target_path, 'excerpt2.edf')            # data
    hfile = os.path.join(target_path, 'Hypnogram_excerpt2.txt')  # hypnogram
    cfile = os.path.join(target_path, 'excerpt2_config.txt')     # GUI config

    # Define an instance of Sleep :
    sp = Sleep(data=dfile, hypno=hfile, config_file=cfile)


.. GENERATED FROM PYTHON SOURCE LINES 42-44

Define new methods
##############################################################################

.. GENERATED FROM PYTHON SOURCE LINES 46-48

Spindle function
~~~~~~~~~~~~~~~~

.. GENERATED FROM PYTHON SOURCE LINES 50-53

This function does NOT perform a real spindle detection. It's purpose is to
show how to replace the default detection behavior by a custom function.
It just highlights samples between [0, 100], [200, 300] and [400, 500].

.. GENERATED FROM PYTHON SOURCE LINES 54-62

.. code-block:: Python


    def fcn_spindle(data, sf, time, hypno):  # noqa
        """New spindle detection function."""
        indices = np.array([[0, 100],
                           [200, 300],
                           [400, 500]])
        return indices


.. GENERATED FROM PYTHON SOURCE LINES 63-65

Rapid eye movement function
~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. GENERATED FROM PYTHON SOURCE LINES 67-71

This function does NOT perform a real REM detection. It illustrates how to
replace the default detection behavior by a basic thresholding function.
Note that the function returns a boolean array indicating samples that are
above a specific threshold.

.. GENERATED FROM PYTHON SOURCE LINES 71-79

.. code-block:: Python


    def fcn_rem(data, sf, time, hypno):  # noqa
        """New REM detection function."""
        mean_data = np.mean(data)
        std_data = np.std(data)
        # Threshold is mean + 3 * STD
        return data > mean_data + 3. * std_data


.. GENERATED FROM PYTHON SOURCE LINES 80-84

Replace existing methods
##############################################################################
 Now we use the :class:`visbrain.gui.Sleep.replace_detections` method to
 overwrite existing spindles and REM detections.

.. GENERATED FROM PYTHON SOURCE LINES 84-92

.. code-block:: Python


    # Replace the spindle detection function :
    sp.replace_detections('spindle', fcn_spindle)
    # Replace the REM detection function :
    sp.replace_detections('rem', fcn_rem)

    # Finally, open the graphical user interface :
    sp.show()


.. _sphx_glr_download_auto_examples_gui_sleep_replace_detection_basic.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: replace_detection_basic.ipynb <replace_detection_basic.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: replace_detection_basic.py <replace_detection_basic.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: replace_detection_basic.zip <replace_detection_basic.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
